# Network Traffic Analysis - Instructor Guide

## Setup

### Environment Preparation

**Pre-Class Checklist (15 minutes before class):**
```bash
# Navigate to main project directory
cd /workspaces/Secure_Architecture_Sandbox_Testing_Environment

# Start containerized network environment
cd docker && docker-compose up -d

# Verify network analysis tools are available
python src/tools/network_analysis.py --help
nmap --version
netstat --version
```

**Student Prerequisites:**
- Basic computer literacy (file navigation, command copying)
- No networking knowledge required
- Completed previous sandbox exercises recommended

### Class Setup
- **Duration**: 3-4 hours (can be split into 2 sessions)
- **Class Size**: 15-25 students optimal
- **Equipment**: Individual computers with sandbox environment
## Teaching Notes

### ğŸ¯ Core Concepts

**What is Network Analysis?**
- Monitoring computer communications to detect security threats
- Different from code analysis - focuses on runtime network behaviour
- Like being a security guard watching all building entrances
- Essential for detecting active attacks and intrusions

**Key Analogies:**
- SAST = Reading building blueprints for safety issues
- DAST = Testing if doors and windows lock properly
- Sandbox = Watching suspicious people in a controlled room
- Network = Monitoring all visitor traffic around the building

### ğŸ“š Teaching Approach

**Basic Commands Students Will Use:**
```bash
# View current network connections
netstat -tuln
ss -tuln

# Monitor network activity
python src/analyser/network_cli.py --monitor-connections --educational

# Scan for running services
python src/analyser/network_cli.py --scan-services localhost

# Baseline vs suspicious activity comparison
python src/analyser/network_cli.py --demo-network --educational
```

**Expected Results:**
- Normal connections: SSH (22), HTTP (80), HTTPS (443), DNS (53)
- Suspicious indicators: Unknown high ports, unusual connection patterns
- Service discovery: Web servers, databases, ssh services

### ğŸ”¬ Hands-On Activities

**Activity 1: Network Connection Monitoring**
Students observe current network connections and learn to identify normal vs suspicious patterns.

**Activity 2: Service Discovery**
Students scan for running services and assess security risks of exposed services.

**Activity 3: Traffic Pattern Analysis**
Students establish baselines and compare against potentially malicious activity.

### ğŸ¯ Key Discussion Points

**Network Security Fundamentals:**
- Why monitor network traffic (real-time threat detection)
- What constitutes suspicious network behaviour
- Common attack patterns (port scanning, unusual connections)
- Difference between expected and unexpected network activity

**Risk Assessment:**
- High-risk services: Databases, admin interfaces, development tools
- Medium-risk: Web servers, file shares
- Low-risk: Standard system services
- Critical indicators: Unknown ports, foreign connections, excessive traffic

**Real-World Applications:**
- Network intrusion detection systems (NIDS)
- Security operations centre (SOC) monitoring
- Incident response and forensics
- Compliance monitoring (PCI DSS, HIPAA)

## Troubleshooting

### Common Setup Issues

**Network Monitoring Problems:**
```bash
# Test basic network tools
netstat --version && ss --version

# Verify custom tool functionality
python src/analyser/network_cli.py --help

# Use demo data if live monitoring unavailable
python src/analyser/network_cli.py --demo-network --educational
```

**Permission Issues:**
```bash
# Use connection monitoring instead of packet capture
python src/analyser/network_cli.py --monitor-connections --educational

# Explain to students: full packet capture requires admin privileges
```

### Student Support Strategies

**Technical Output Confusion:**
- Focus on specific port numbers (22, 80, 443, 4444)
- Use provided grep commands to filter technical details
- Emphasise pattern recognition over detailed analysis

**Overwhelming Information:**
- Start with simple netstat output
- Use analogies consistently (security guard watching doors)
- Break down complex commands into smaller steps

**Analysis Difficulties:**
- Provide expected result examples
- Use demo mode when live network unavailable
- Focus on concepts over exact technical details
```

### ğŸ¯ What Should Happen:

- Network tool shows help information (means it's working)
- Monitor command shows connection data (even if empty)
- System tools respond with help text (means they're available)

### âŒ If Something's Wrong:

Use the troubleshooting section at the bottom of this guide

## ğŸ“‹ Simple Lesson Plan

### ğŸš€ Introduction (30 minutes)

#### Opening Hook (5 minutes)

**ğŸ¯ Ask Students**: "How would you know if someone was secretly using your WiFi
or trying to hack your computer?"

- Discuss the importance of monitoring network activity
- Share news stories about network attacks (like hospital ransomware)
- Introduce the concept of "network security guards"

#### ğŸŒ Network Analysis Overview (15 minutes)

**ğŸ’¬ Key Teaching Points (Use Simple Analogies)**:

**What is Network Analysis?**

- Like being a security guard monitoring all doors and windows
- Watching who comes and goes from your computer
- Different from other security methods we've learned:
  - **SAST** = Reading building blueprints for problems
  - **DAST** = Testing if doors and windows lock properly
  - **Sandbox** = Watching suspicious people in a safe room
  - **Network** = Monitoring all foot traffic around the building

#### ğŸ’» Simple Demo for Class:

```bash
# Step 1: Make sure you're in the main folder
cd /workspaces/Secure_Architecture_Sandbox_Testing_Environment

# Step 2: Show current network connections (like seeing who's visiting)
netstat -tuln | head -10

# Step 3: Use our specialised monitoring tool
python src/analyser/network_cli.py --monitor-connections --educational
```

**ğŸ’¬ Explain to Students**: "The first command shows basic connections, the
second command is like having a professional security system that gives much
more detail."

#### ğŸ› ï¸ Tool Introduction (10 minutes)

**Essential Tools (Explain with Simple Analogies)**:

- **network_cli.py**: Our professional network security system
- **netstat**: Basic connection viewer (like looking out a window)
- **ss**: Modern version of netstat (like having security cameras)
- **nmap**: Network scanner (like walking around checking all doors and windows)

### ğŸ” Exercise 1: Watching Network Connections (45 minutes)

#### ğŸ“ Setup Phase (10 minutes)

**ğŸ¯ Instructor Demonstration**:

```bash
# Step 1: Make sure you're in the main folder
cd /workspaces/Secure_Architecture_Sandbox_Testing_Environment

# Step 2: Start monitoring network activity
python src/analyser/network_cli.py --monitor-connections --educational --verbose

# Step 3: Show what normal connections look like
echo "These are the current connections on our system"
```

**ğŸ’¬ Expected Educational Output**: Students will see detailed explanations
starting with:

```
ğŸ“ EDUCATIONAL INSIGHTS
Understanding Network Connection Monitoring:

Network monitoring is essential for cybersecurity because it helps identify:
- Unauthorized connections to your systems
- Data exfiltration attempts
- Command and control communications
- Lateral movement within networks

[Additional detailed analysis follows...]
```

**ğŸ’¬ Explain to Students**: "This shows us who our computer is talking to right
now. Just like a phone bill shows who you called, this shows what websites and
servers our computer is communicating with. The educational insights explain why
this matters for security."

**ğŸ‘¥ Student Activity**: Students run the same commands to see their baseline
network state

#### ğŸ•µï¸ Analysis Phase (25 minutes)

**ğŸ¯ Guided Discovery** (help students interpret what they see):

**1. ğŸŒ Looking for Normal Web Connections**:

```bash
# Look for standard web traffic (ports 80 and 443)
netstat -tuln | grep ":80\|:443\|:22"
```

**ğŸ’¬ Explain**: "Port 80 = regular websites, Port 443 = secure websites (HTTPS),
Port 22 = secure remote access" **âœ… Expected Finding**: Should see web services
if any websites are running

**2. âš ï¸ Looking for Suspicious Ports**:

```bash
# Search for common hacker ports
netstat -tuln | grep -E ":4444|:6666|:1337|:31337"
```

**ğŸ’¬ Explain**: "These port numbers are commonly used by hackers for backdoors
and remote control" **âœ… Expected Finding**: Should find NONE in a normal,
secure environment

**3. ğŸŒ Looking for External Communications**:

```bash
# See what external servers we're talking to
netstat -tuln | grep -v "127.0.0.1\|::1"
```

**ğŸ’¬ Explain**: "127.0.0.1 means 'talking to ourselves' - anything else means
talking to other computers" **âœ… Expected Finding**: May see connections to
external websites and services

#### ğŸ’­ Discussion Phase (10 minutes)

**ğŸ¯ Key Questions for Class Discussion**:

**Q**: "What should you be worried about in network connections?" **A**: Help
students identify:

- âœ… Connections on ports 80/443 are normal for web browsing
- âš ï¸ Connections on ports 4444/6666/1337 are suspicious (hacker favourites)
- âš ï¸ Too many connections to the same IP might mean scanning
- âš ï¸ Connections to unknown countries might be suspicious

**Q**: "How could attackers use network connections to hurt you?" **A**: Discuss
real scenarios:

- Steal personal files and send them to criminal servers
- Install remote control software (backdoors)
- Use your computer to attack other people

**Q**: "Why is monitoring network activity important?" **A**: Emphasise that:

- You can catch attacks as they happen
- You can collect evidence for police/IT security
- You can block suspicious connections before damage occurs

### ğŸ” Exercise 2: Finding What Services Are Running (45 minutes)

#### ğŸ¯ Discovery Phase (20 minutes)

**ğŸ’¬ What Are Services?** Services = programmes that wait for other computers to
connect to them

- Like having different employees at different desk numbers in a company
- Port numbers = desk numbers (Port 80 = web service desk, Port 22 = secure
  access desk)

**ğŸ’» Student Task**: Find what services are running on our computer

```bash
# Step 1: Make sure you're in the main folder
cd /workspaces/Secure_Architecture_Sandbox_Testing_Environment

# Step 2: Scan our own computer for services
python src/analyser/network_cli.py --scan-services localhost --educational

# Step 3: Use built-in system tools to double-check
netstat -tuln | grep LISTEN
```

**ğŸ¯ Teaching Strategy - Provide Hints Progressively**:

1. **First hint**: "Look for common port numbers like 22, 80, 443"
2. **Second hint**: "LISTEN means a service is waiting for connections"
3. **Final hint**: "Research what each port number is typically used for"

#### âœ… Expected Services Students Should Find:

- **Port 22**: SSH (secure remote access - good but monitor for break-in
  attempts)
- **Port 80**: HTTP (insecure websites - should upgrade to HTTPS)
- **Port 443**: HTTPS (secure websites - good)
- **Port 3389**: RDP (Windows remote desktop - high risk, should be firewalled)
- **Port 5900**: VNC (remote screen sharing - high risk, weak security)

#### âš ï¸ Security Analysis Phase (15 minutes)

**ğŸ’» Risk Assessment Commands for Students**:

```bash
# Step 1: Save service scan results
python src/analyser/network_cli.py --scan-services localhost --educational > services_found.txt

# Step 2: Look for high-risk services
cat services_found.txt | grep -E "3389|5900|23|21"

# Step 3: Count total services found
cat services_found.txt | grep -c "Port"
```

**ğŸ¯ Teaching Students to Assess Risk**:

- **Green (Safe)**: Ports 443 (HTTPS), 53 (DNS)
- **Yellow (Monitor)**: Ports 22 (SSH), 80 (HTTP)
- **Red (Dangerous)**: Ports 23 (Telnet), 21 (FTP), 3389 (RDP), 5900 (VNC)

#### ğŸ“ Documentation Phase (10 minutes)

**ğŸ‘¥ Student Activity** - Have students fill out this table:

| Port Found | Service Name | Risk Level | Why Risky?                          |
| ---------- | ------------ | ---------- | ----------------------------------- |
| 22         | SSH          | Medium     | Could be brute-forced               |
| 80         | HTTP         | Medium     | Unencrypted web traffic             |
| 443        | HTTPS        | Low        | Encrypted and secure                |
| 3389       | RDP          | High       | Weak authentication, often targeted |

### ğŸŒ Exercise 3: Analysing Network Traffic Patterns (40 minutes)

#### ğŸ“Š Baseline Establishment (10 minutes)

**ğŸ’¬ What is a Baseline?** Baseline = understanding what normal network activity
looks like

- Like knowing your normal daily routine to spot when something unusual happens
- Helps distinguish between normal activity and potential attacks

**ğŸ’» Commands for Students**:

```bash
# Step 1: Make sure you're in the main folder
cd /workspaces/Secure_Architecture_Sandbox_Testing_Environment

# Step 2: Capture normal network activity for 30 seconds
python src/analyser/network_cli.py --capture-traffic --duration 30 --educational

# Step 3: Save baseline for comparison
echo "Baseline captured - this shows our normal network behaviour"
```

#### ğŸ­ Activity Generation (15 minutes)

**ğŸ’» Generate Different Types of Network Activity**:

```bash
# Create legitimate network activity (safe to run)
curl http://httpbin.org/get
curl http://httpbin.org/post -d "test=data"

# Simulate suspicious activity (these will fail safely - that's the point)
for port in 4444 6666 1337; do
    timeout 1 nc -z malicious-server.example.com $port 2>/dev/null || echo "Suspicious connection attempt failed (expected)"
done
```

**ğŸ’¬ Explain to Students**: "We're creating both normal activity (like visiting
websites) and suspicious activity (like trying to connect to hacker servers) to
see the difference."

#### ğŸ“ˆ Pattern Analysis (15 minutes)

**ğŸ¯ Key Metrics Students Should Analyse**:

**ğŸ’» Analysis Commands**:

```bash
# Step 1: Look at protocol usage
netstat -s | grep -E "tcp|udp" | head -5

# Step 2: Check for failed connections (sign of scanning or attacks)
dmesg | grep -i "connection" | tail -5

# Step 3: Monitor active connections
python src/analyser/network_cli.py --monitor-connections --educational
```

**âœ… Expected Findings Students Should Observe**:

- **Normal Activity**: HTTP requests to legitimate servers (httpbin.org)
- **DNS Activity**: Name lookups for websites
- **Failed Connections**: Attempts to reach suspicious/non-existent servers
- **Protocol Patterns**: Mostly TCP for web traffic, some UDP for DNS

**ğŸ¯ Teaching Points**:

- **Many failed connections = possible scanning attack**
- **Connections to unusual countries = possible data theft**
- **High network usage = possible data exfiltration**
- **Regular, automated patterns = possible malware**

### ğŸ” Exercise 4: DNS Analysis (30 minutes)

#### ğŸ’¬ What is DNS?

**DNS = Domain Name System** (like a phone book for the internet)

- Converts website names (google.com) to computer addresses (172.217.164.110)
- Attackers often abuse DNS for hidden communication
- Monitoring DNS can reveal malware and data theft

#### ğŸ¯ DNS Monitoring Setup (10 minutes)

**ğŸ’» Commands for Students**:

```bash
# Step 1: Make sure you're in the main folder
cd /workspaces/Secure_Architecture_Sandbox_Testing_Environment

# Step 2: Start monitoring DNS activity
python src/analyser/network_cli.py --dns-analysis --duration 30 --educational

# Step 3: Generate normal DNS activity in another terminal
# (Students can open a second terminal window)
```

#### ğŸŒ Query Generation (10 minutes)

**ğŸ’» Create Normal vs Suspicious DNS Activity**:

```bash
# Normal, legitimate DNS queries
nslookup google.com
nslookup github.com
nslookup youtube.com

# Suspicious DNS queries (these will fail - that's the point)
nslookup very-long-suspicious-domain.evil.com 2>/dev/null || echo "Suspicious domain failed (expected)"
nslookup c2-server.malware.net 2>/dev/null || echo "Malware domain failed (expected)"
```

**ğŸ’¬ Explain to Students**: "We're testing both normal website lookups and
suspicious domain names that real malware might use."

#### ğŸš¨ Pattern Recognition (10 minutes)

**ğŸ¯ DNS Threat Indicators Students Should Learn**:

**âš ï¸ Warning Signs in DNS Activity**:

- **Very long domain names** (might be hiding data in the name)
- **Random-looking domain names** (generated by malware)
- **Many failed DNS lookups** (malware trying to contact dead servers)
- **High frequency of DNS queries** (possible data tunneling)

**ğŸ’» Analysis Commands**:

```bash
# Look for failed DNS queries
grep -i "fail\|error" /var/log/syslog | grep -i dns | tail -5 2>/dev/null || echo "No DNS errors found"

# Check for unusual domain patterns
echo "Look for domains with random letters or very long names in your DNS monitoring output"
```

**âœ… Expected Findings Students Should See**:

- **Normal DNS patterns**: Queries to major websites (google.com, etc.)
- **Suspicious query attempts**: Failed lookups to malware-related domains
- **Query frequency analysis**: Normal queries are sporadic, attacks are often
  frequent

**ğŸ¯ Real-World Examples to Share**:

- **DNSChanger malware** redirected users to fake websites through DNS
- **Conficker worm** used DNS to find new command servers
- **DNS tunneling** lets attackers steal data through DNS queries

### ğŸ“ Assessment and Wrap-up (30 minutes)

#### ğŸ’¼ Practical Assessment (20 minutes)

**ğŸ“‹ Scenario for Students**: "You're the IT security person for a small
company. Analyse this simulated network activity and write a report."

**ğŸ’» Assessment Commands**:

```bash
# Step 1: Make sure you're in the main folder
cd /workspaces/Secure_Architecture_Sandbox_Testing_Environment

# Step 2: Run comprehensive network analysis
python src/analyser/network_cli.py --demo-network --educational

# Step 3: Students analyse results and write brief report
```

**âœ… Assessment Criteria for Teachers**:

1. **Tool Usage**: Can students run commands correctly?
2. **Threat Identification**: Do they spot suspicious patterns?
3. **Evidence Documentation**: Can they explain what they found?
4. **Risk Assessment**: Do they understand which problems are most dangerous?

#### ğŸ§  Quick Knowledge Check (10 minutes)

**ğŸ’­ Simple Quiz Questions for Class**:

**Q1**: "Which port numbers are commonly used by hackers for backdoors?" **A**:
4444, 6666, 1337, 31337

**Q2**: "What might lots of failed DNS queries indicate?" **A**: Possible
malware trying to contact command servers, or DNS tunneling attempts

**Q3**: "Name three signs of suspicious network activity" **A**: Port scanning
(many connection attempts), unusual foreign connections, high data transfer to
unknown servers

**Q4**: "Why is network monitoring important for cybersecurity?" **A**: Catches
attacks in real-time, provides evidence for investigations, helps block threats
before damage

## ğŸš¨ Simple Troubleshooting Guide

### âŒ Problem: Students can't see network connections

**âœ… Solution**:

```bash
# Try alternative commands
ss -tuln  # newer version of netstat

# Use our demo data if no real connections
cd /workspaces/Secure_Architecture_Sandbox_Testing_Environment
python src/analyser/network_cli.py --demo-network --educational
```

### âŒ Problem: "Permission denied" for network monitoring

**âœ… Solution**:

```bash
# Use connection monitoring instead of packet capture
python src/analyser/network_cli.py --monitor-connections --educational

# Explain to students: "Full packet capture requires administrator privileges"
```

### âŒ Problem: Network tools not found

**âœ… Solution**:

```bash
# Check what tools are available
which netstat ss nmap

# Use built-in Python tools if system tools missing
python src/analyser/network_cli.py --scan-services localhost
```

### âŒ Problem: Students get confused by technical output

**âœ… Teaching Strategy**:

- **Focus on patterns**: "Look for the port numbers we discussed (22, 80, 443,
  4444)"
- **Use the grep commands provided**: They filter out most technical details
- **Emphasise concepts**: Understanding threat types is more important than
  reading every detail

**ğŸ¯ Pro Tip**: Practice all commands yourself before class and prepare simple
explanations for common output patterns!
